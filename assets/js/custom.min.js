var newURL=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,pathArray=newURL.split("/"),len=pathArray.length;if("localhost"===location.hostname||"127.0.0.1"===location.hostname||location.hostname===my_ip)if(len>5)var url=window.location.protocol+"//"+window.location.host+"/"+pathArray[3]+"/"+pathArray[4]+"/"+pathArray[5];else url=window.location.protocol+"//"+window.location.host+"/"+pathArray[3]+"/"+pathArray[4];else url=len>4?window.location.protocol+"//"+window.location.host+"/"+pathArray[3]+"/"+pathArray[4]:window.location.protocol+"//"+window.location.host+"/"+pathArray[3];function searchFilter(a){a=a||0;var t=$("#trx").val(),n=$("#keywords").val(),o=$("#sortBy").val(),r=$("#limits").val(),i=$("#tgl").val(),e=base_url+"penjualan/ajaxPaginationData/"+a;$.ajax({type:"POST",url:e,data:{page:a,keywords:n,sortBy:o,limits:r,trx:t,tgl:i},beforeSend:function(){$("body").loading()},success:function(a){$("#dataList").html(a),load_total(t),$("body").loading("stop")},error:function(a,t,n){sweet("Peringatan!!!",n,"warning","warning"),$("body").loading("stop")}})}function load_total(a){status=a||0,$.ajax({url:base_url+"penjualan/load_total",data:{status:a},method:"POST",dataType:"json",success:function(a){$(".total_order").html(a.total_order),$(".total_bayar").html(a.total_bayar),$(".total_diskon").html(a.total_diskon),$(".total_piutang").html(a.total_piutang)},error:function(a,t,n){var o=a.responseText;sweet("Server!!!",o,"error","danger")}})}$("li.nav-item a").filter((function(){return this.href==url})).parentsUntil(".sidebar > .nav-link collapsed").addClass("active"),$("li.nav-item a").filter((function(){return this.href==url})).closest(".collapse").addClass("show"),$(".collapse-item").filter((function(){return this.href==url})).closest("a").siblings().removeClass("active").end().addClass("active").css({display:"block"}),jQuery(document).ready((function(){jQuery("#viewerContainer").scrollbar(),jQuery(".scrollbar-inner").scrollbar(),jQuery(".scrollbar-dynamic").scrollbar(),jQuery(".scrollbar-vista").scrollbar({showArrows:!0,scrollx:"advanced",scrolly:"advanced"})})),$(".dropdown").on("shown.bs.dropdown",(function(a){$(".dropdown-menu input").focus()})),load_total(),$(document).on("click",".clear",(function(){$(this).tooltip("hide"),$(".date-order").val(""),$("#keywords").val(""),$("#trx").val(0),$("#limits").val(10),$("#sortBy").val("DESC"),searchFilter()})),$(document).on("click",".ceklunas",(function(){$("#trx").val(1),searchFilter()})),$(document).on("click",".cekPending",(function(){$("#trx").val("pending"),searchFilter()})),$(document).on("click",".cekBaru",(function(){$("#trx").val("baru"),searchFilter()})),$(document).on("click",".cekBatal",(function(){$("#trx").val("batal"),searchFilter()})),$(document).ready((function(){$("body").tooltip({selector:"[data-tooltip=tooltip]",container:"body"})})),$(".select2-profil").select2();var dengan_rupiah=document.getElementById("uangm");dengan_rupiah.addEventListener("keyup",(function(){dengan_rupiah.value=formatRupiah(this.value,"Rp.")}));var diskon_rupiah=document.getElementById("total_diskon");diskon_rupiah.addEventListener("keyup",(function(){diskon_rupiah.value=formatRupiah(this.value,"Rp.")}));var start=moment().startOf("month"),end=moment();function cb(a,t){$("#reportrange span").html(a.format("DD/MM/YYYY")+" - "+t.format("DD/MM/YYYY"))}function saved(a){ukuran=$("#ukuran_"+a.toString()).val(),totukuran=$("#totukuran_"+a.toString()).val(),id_invoice=$("#id_invoice").val(),totalSum=angka($("#totalSum").val()),uangmuka=angka($("#uangmuka").val()),id_produk=$("#id_produk_"+a.toString()).val(),jumlah=angka($("#jumlah_"+a.toString()).val()),harga=angka($("#harga_"+a.toString()).val()),id_rincianinvoice=$("#id_rincianinvoice_"+a.toString()).val(),satuan=$("#satuan_"+a.toString()).val(),id_bahan=$("#id_bahan_"+a.toString()).val(),jenis=$("#id_jenis_"+a.toString()).val(),diskon=angka($("#diskon_"+a.toString()).val()),type_harga=$("#status_"+a.toString()).val(),hargasatuan=angka($("#hargasatuan_"+a.toString()).val()),$("#satuan_"+a.toString()+' option[value="'+satuan+'"]').prop("selected",!0),$.ajax({url:base_url+"penjualan/auto_save_invoice_detail",type:"POST",data:{id_invoice:id_invoice,id_produk:id_produk,jumlah:jumlah,harga:harga,id_rincianinvoice:id_rincianinvoice,ukuran:ukuran,totukuran:totukuran,satuan:satuan,id_bahan:id_bahan,jenis:jenis,diskon:diskon,jml:totalSum,uangmuka:uangmuka,type_harga:type_harga},dataType:"json",success:function(t){$("#button_"+a.toString()).attr("disabled",!1),400==t.status?(sweet("Peringatan!!!","Maaf data tidak bisa di update","warning","warning"),$("#jumlah_"+a.toString()).val(t.jml),$("#harga_"+a.toString()).val(t.harga),$("#diskon_"+a.toString()).val(t.diskon)):401==t.status&&(sweet_time(2500,"Peringatan!!!",t.msg),$("#harga_"+a.toString()).val(t.harga),$("#hargasatuan_"+a.toString()).val(0),$("#hargasatuan_"+a.toString()).focus())},error:function(a,t,n){sweet("Peringatan!!!",n,"warning","warning")}})}$("#reportrange").daterangepicker({startDate:start,endDate:end,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}},cb),cb(start,end),$(document).on("click",".cari_qr",(function(a){a.preventDefault();var t=$("#cari_qr").val();if(""==$("#cari_qr").val())return $("#cari_qr").addClass("form-control-warning"),showNotif("top-center","Input Data","Harus diisi","warning"),void $("#cari_qr").focus();$.ajax({url:base_url+"produk/ajax",type:"POST",data:{name_startsWith:t,type:"produk_table_qr",row_num:1},dataType:"json",success:function(a){var t=a[0].split("|");$("#cari_produk").val(t[0]),$("#kodeproduk").val(t[0]),$("#harga").val(t[1]),$("#id_produk").val(t[2]),$("#jenis_cetakan").val(t[3]),$("#bahan").val(t[4]),$("#id_jenis").val(t[5]),$("#id_bahan").val(t[6]),$("#status_hitung").val(t[7]),$("#satuan_add").val(t[8]),$("#ukuran").val(t[9]),$("#jumlah").val(t[10]),$("#lock").val(t[11]),$("#type_harga").val(t[12]),$("#button-qr").modal("hide"),$("#formcheckin").submit()},error:function(a,t,n){sweet("Peringatan!!!",n,"warning","warning")}})}));