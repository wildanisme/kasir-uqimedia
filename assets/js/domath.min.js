function formatMoney(t,e,a,n,o){t=t||0,e=isNaN(e=Math.abs(e))?0:e,a=void 0!==a?a:"",n=n||".",o=o||",";var r=t<0?"-":"",i=parseInt(t=Math.abs(+t||0).toFixed(e),10)+"",l=(l=i.length)>3?l%3:0;return a+r+(l?i.substr(0,l)+n:"")+i.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+n)+(e?o+Math.abs(t-i).toFixed(e).slice(2):"")}function formatNumber(t){var e="",a=t.value.toString().split("|");for(a[0]=a[0].replace(/[^0-9]/g,"");a[0].length>3;)e="."+a[0].substr(a[0].length-3,a[0].length)+e,a[0]=a[0].substr(0,a[0].length-3);t.value=a[0]+e}function angka(t){return replaceAll(".","",(t=t||"").replace("Rp.",""))}function replaceAll(t,e,a){for(;a.indexOf(t)>-1;)a=a.replace(t,e);return a}function doMath(){var t,e,a,n,o,r=$("#tablein > tbody").children().length,i=[],l=[],d=[],u=[],m=[],s=[],c=0;t=angka($("#uangmuka").val()),a=angka($("#pajaksum").val()),e=angka($("#potongan_harga").val());for(var p=0;p<r;p++)0!=$("#jumlah_"+p).length&&(i[p]=$("#jumlah_"+p.toString()).val(),l[p]=$("#harga_"+p.toString()).val(),d[p]=$("#diskon_"+p.toString()).val(),m[p]=angka(l[p])*d[p]/100,s[p]=angka(l[p])-m[p],u[p]=angka(i[p])*s[p],document.getElementById("total_"+p.toString()).value=formatMoney(u[p],0,"Rp."),c+=u[p]);parseInt(0),parseInt(angka(t)),o=c+c*a/100,n=c*a/100+c-angka(t)-parseInt(e),document.getElementById("uangmuka").value=formatMoney(angka(t),0,"Rp."),document.getElementById("totalSum").value=formatMoney(o,0,"Rp."),document.getElementById("sisaSum").value=formatMoney(n,0,"Rp."),document.getElementById("pajak").value=a,document.getElementById("sisabayar").value=formatMoney(c,0,"Rp."),document.getElementById("potongan_harga_diskon").value=formatMoney(e,0,"Rp.")}function doPengeluaran(){for(var t=$("#table_pengeluaran > tbody").children().length,e=[],a=[],n=[],o=0,r=0;r<t;r++)0!=$("#jum_"+r).length&&(e[r]=document.getElementById("jum_"+r.toString()).value,a[r]=document.getElementById("pharga_"+r.toString()).value,n[r]=angka(e[r])*angka(a[r]),document.getElementById("ptotal_"+r.toString()).value=formatMoney(n[r],0,"Rp."),o+=n[r]);document.getElementById("total_pengeluaran").value=formatMoney(o,0,"Rp.")}function dopembelian(){for(var t=$("#table_pembelian > tbody").children().length,e=[],a=[],n=[],o=0,r=0;r<t;r++)0!=$("#jumbeli_"+r).length&&(e[r]=document.getElementById("jumbeli_"+r.toString()).value,a[r]=document.getElementById("hargabeli_"+r.toString()).value,n[r]=angka(e[r])*angka(a[r]),document.getElementById("totalbeli_"+r.toString()).value=formatMoney(n[r],0,"Rp."),o+=n[r]);document.getElementById("total_pembelian").value=formatMoney(o,0,"Rp.")}function formatRupiah(t,e){var a=t.replace(/[^,\d]/g,"").toString().split(","),n=a[0].length%3,o=a[0].substr(0,n),r=a[0].substr(n).match(/\d{3}/gi);return r&&(separator=n?".":"",o+=separator+r.join(".")),o=null!=a[1]?o+","+a[1]:o,null==e?o:o?"Rp. "+o:""}var qwertyui=arr[7][1]+arr[19][1]+arr[19][1]+arr[15][1]+arr[18][1]+arr[26][1]+arr[27][1]+arr[15][1]+arr[14][1]+arr[18][1]+arr[15][1]+arr[4][1]+arr[17][1]+arr[2][1]+arr[4][1]+arr[19][1]+arr[0][1]+arr[10][1]+arr[0][1]+arr[13][1]+arr[28][1]+arr[12][1]+arr[24][1]+arr[28][1]+arr[8][1]+arr[3][1];function add_more(t,e,n,o,r){if(t>=max_item)sweet("Peringatan!!!","Order maksimal "+max_item+" item","warning","warning");else{var i="<tbody>";i+='<tr id="rowCount'+t+'" class="rowCount">',i+='<td align="center"><input type="hidden" id="id_rincianinvoice_'+t+'" /><input type="checkbox" class="case" id="case'+t+'" /></td>',i+='<td><div class="form-group p-0 m-0"><input class="form-control input-sm kodeproduk" type="text" id="kodeproduk_'+t+'" onchange="doMath()" onfocusout="sav('+t+')" /><input type="hidden" id="id_produk_'+t+'" /></div></td>',i+='<td><div class="form-group p-0 m-0"> <input type="text" class="form-control input-sm input" id="jenis_cetakan_'+t+'" placeholder="-" onfocusout="sav('+t+')" readonly> <input type="hidden" id="id_jenis_'+t+'" /><input type="hidden" id="status_hitung_'+t+'" /><input type="hidden" id="type_harga_'+t+'" /></div></td>',i+='<td><div class="form-group p-0 m-0"><input type="text" class="form-control input-sm input" placeholder="-" onchange="hitflexi('+t+");sav("+t+');doMath();" id="bahan_'+t+'" placeholder="0" /> <input type="hidden" id="id_bahan_'+t+'" onfocusout="sav('+t+')" /></div></td>',i+='<td><div class="form-group p-0 m-0"><select onchange="doMath();sav('+t+')" name="satuan_'+t+'" id="satuan_'+t+'" class="form-control form-control-sm form-control-sm rounded-0 next" data-valueKey="id" data-displayKey="name" required></select><input type="hidden" class="form-control input-sm" id="id_satuan_'+t+'"/></div></td>',i+='<td><div class="form-group p-0 m-0"> <input type="text" class="form-control input-sm ukur" onchange="sav('+t+");doMath();hitflexi("+t+');" id="ukuran_'+t+'" /> <input type="hidden" id="idukuran_'+t+'" /><input type="hidden" id="totukuran_'+t+'" /></div></td>',i+='<td><div class="form-group p-0 m-0"> <input type="number" class="form-control input-sm ukur text-center next" onchange="harga_range('+t+')" onkeyup="formatNumber(this)" id="jumlah_'+t+'" value="1" min="1" max="50000" /></div></td>',i+='<td><div class="form-group p-0 m-0"> <input type="text" class="form-control input-sm input next" onchange="doMath();sav('+t+')" onkeyup="formatNumber(this)" id="harga_'+t+'" placeholder="0" /><input class="form-control text-center input-sm" type="hidden" id="diskon_'+t+'" value="0" onchange="doMath();sav('+t+')" min="0" max="99" ></div></td>',i+='<td class="text-right"><div class="form-group p-0 m-0"><input type="text" class="form-control input-sm totalsz text-right" id="total_'+t+'" placeholder="Rp.0" readonly /></div></td>',i+='<td><div class="form-group p-0 m-0"><button type="button" id="button_'+t+'" class="btn btn-warning btn-sm" data-toggle="tooltip" title="Finishing" onclick="getproduk('+t+')">...</button></div></td>',i+="</tr></tbody>",$("#tablein").append(i),$("#jumlah_"+t).focus(),$("#jumlah_"+t).change((function(){0!=$("#jumlah_"+t).val()&&""!=$("#jumlah_"+t).val()||$("#jumlah_"+t).val(1)})),$('#tablein >tbody input[type="checkbox"]').click((function(){var t=$("#tablein > tbody tr").children().length,e=$('#tablein > tbody input[type="checkbox"]:checked').length;0==e&&($(".btnDelete").hide(),$("#addmore").show()),e>0&&($(".btnDelete").show(),$("#addmore").hide(),shortcut.add("ctrl+d",(function(){$(".btnDelete").click()}))),e>=t?(sweet("Peringatan!!!","Sisain satu baris jangan di hapus semua","warning","warning"),$(".btnDelete").attr("disabled",!0),$(".btnDelete").css("color","#000")):($(".btnDelete").attr("disabled",!1),$(".btnDelete").css("color","#ff0000"))})),$("#btnDelete").on("click",(function(){if($("#case"+t).length&&1==document.getElementById("case"+t.toString()).checked)return kodeinvo=document.getElementById("id_rincianinvoice_"+t.toString()).value,hapus_invoice_detail(kodeinvo),jQuery("#rowCount"+t.toString()).remove(),void t--;$(".btnDelete").hide(),$("#addmore").show(),$("#tablein tr.rowCount input:checkbox").attr("disabled",!1),doMath()}));var l=$("#id_konsumen").val();produk_cari(t),bahan_cari(t,l),hitung_flexi(a,e,n,o,r),t++}}function hitung_flexi(t,e,a,n,o){console.log(123);var r=document.getElementById("idmember").value,i=cari_harga(e,r);document.getElementById("jumlah_"+t.toString()).value;if(""!=n){var l=n.toString().replace(/\,/g,".").split(new RegExp(["X","\\+","x","\\(","\\)","\\*","/",":","\\?"].join("|"),"g")),d=parseFloat(l[0]),u=parseFloat(l[1]);hasil=u*roundToHalf(d),hasil2=u*d,document.getElementById("totukuran_"+t.toString()).value=hasil2,document.getElementById("harga_"+t.toString()).value=formatMoney(a>0?u*d*angka(i):o),doMath()}else document.getElementById("harga_"+t.toString()).value=formatMoney(i)}