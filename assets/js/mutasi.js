var dari=start.format("MM/DD/YYYY"),sampai=end.format("MM/DD/YYYY");function search_Mutasi(a,n,e){a=a||0,n=n||"",e=e||"",$.ajaxQueue({type:"POST",url:base_url+"kas/cariMutasi/"+a,data:{page:a,dari:n,sampai:e},dataType:"html",beforeSend:function(){$("body").loading()},success:function(a){"NONE"==a?$("#dataMutasi").hide():($("#dataMutasi").show(),$("#dataMutasi").html(a)),$("body").loading("stop")},error:function(a,n,e){var t=a.responseText;sweet("Server!!!",t,"error","danger"),$("body").loading("stop")}})}function load_tujuan(a){$.ajax({url:base_url+"kas/tujuan_kas",type:"POST",data:{id:a},dataType:"json",beforeSend:function(){$("#tujuan").append("<option value='loading'>loading</option>"),$("#tujuan").empty()},success:function(a){$("#tujuan option[value='loading']").remove(),$("#tujuan").append("<option value=''>Pilih</option>");for(var n=a.length,e=0;e<n;e++){var t=a[e].id,i=a[e].name;$("#tujuan").append("<option value='"+t+"'>"+i+"</option>")}}})}function load_rekening(a){$.ajax({url:base_url+"kas/rekening",type:"POST",data:{id:a},dataType:"json",beforeSend:function(){$("#rekening_dari").append("<option value='loading'>loading</option>"),$("#rekening_dari").empty()},success:function(a){$("#rekening_dari option[value='loading']").remove(),$("#rekening_dari").append("<option value=''>Pilih</option>");for(var n=a.length,e=0;e<n;e++){var t=a[e].id,i=a[e].name;$("#rekening_dari").append("<option value='"+t+"'>"+i+"</option>")}}})}$("#startdate").val(dari),$("#enddate").val(sampai),$(document).on("click",".ranges li",(function(){const a=$('input[name="daterangepicker_start"]').val(),n=$('input[name="daterangepicker_end"]').val();$("#startdate").val(a),$("#enddate").val(n),search_Mutasi(0,a,n)})),$(document).on("click",".applyBtn",(function(){const a=$('input[name="daterangepicker_start"]').val(),n=$('input[name="daterangepicker_end"]').val();$("#startdate").val(a),$("#enddate").val(n),search_Mutasi(0,a,n)})),search_Mutasi(0,dari,sampai),$(".input").click((function(){this.select()})),$(document).on("click",".add_mutasi",(function(a){a.preventDefault();var n=$(this).attr("data-id");$("#ModalMutasi").modal({backdrop:"static",keyboard:!1}),$("#tujuan").attr("disabled",!0),$("#saldo").val(formatMoney(0,0,"Rp.")),0!=n?$("#type").val("edit"):$("#type").val("add")})),$(document).on("click",".cek_saldo",(function(a){a.preventDefault();var n=$("#dari_kas").val(),e=$("#rekening_dari").val();$.ajax({url:base_url+"kas/cek_saldo",type:"POST",data:{rekening:e,idkas:n},dataType:"json",beforeSend:function(){$("body").loading()},success:function(a){200==a.status&&null!=a.saldo?$("#saldo").val(formatMoney(a.saldo,0,"Rp.")):$("#saldo").val(formatMoney(0,0,"Rp.")),$("body").loading("stop")}})})),$("#dari_kas").filter((function(){$.ajax({url:base_url+"kas/jenis_kas_mutasi",type:"POST",dataType:"json",beforeSend:function(){$("#dari_kas").append("<option value='loading'>loading</option>"),$("#dari_kas").empty(),$("#dari_kas").attr("disabled",!1),$("#tujuan").attr("disabled",!0)},success:function(a){$("#dari_kas option[value='loading']").remove(),$("#dari_kas").append("<option value=''>Pilih</option>");for(var n=a.length,e=0;e<n;e++){var t=a[e].id,i=a[e].name;$("#dari_kas").append("<option value='"+t+"'>"+i+"</option>")}}})})),$("#dari_kas").change((function(){var a=$("#dari_kas").val();if($(".rekening").css("display","none"),0==a)return $("#tujuan").empty(),$("#tujuan").append("<option value=''>Pilih</option>"),void $("#tujuan").attr("disabled",!0);110==a?($("#tujuan").attr("disabled",!0),$(".rekening_dari").css("display","block"),load_rekening(a)):($(".rekening_dari").css("display","none"),$("#tujuan").attr("disabled",!1),$.ajax({url:base_url+"kas/tujuan_kas",type:"POST",data:{id:a},dataType:"json",beforeSend:function(){$("#tujuan").append("<option value='loading'>loading</option>"),$("#tujuan").empty()},success:function(a){$("#tujuan option[value='loading']").remove(),$("#tujuan").append("<option value=''>Pilih</option>");for(var n=a.length,e=0;e<n;e++){var t=a[e].id,i=a[e].name;$("#tujuan").append("<option value='"+t+"'>"+i+"</option>")}}}))})),$("#tujuan").change((function(){var a=$("#tujuan").val(),n=$("#rekening_dari").val();110==a?$(".rekening").css("display","block"):$(".rekening").css("display","none"),$.ajax({url:base_url+"kas/rekening",type:"POST",data:{id:a,dari:n},dataType:"json",beforeSend:function(){$("#rekening").append("<option value='loading'>loading</option>"),$("#rekening").empty()},success:function(a){$("#rekening option[value='loading']").remove(),$("#rekening").append("<option value=''>Pilih</option>");for(var n=a.length,e=0;e<n;e++){var t=a[e].id,i=a[e].name;$("#rekening").append("<option value='"+t+"'>"+i+"</option>")}}})})),$(document).on("click",".save_mutasi",(function(a){$("#myForm").submit()})),$("#myForm").submit((function(a){a.preventDefault();var n=$("#tujuan").val(),e=angka($("#jumlah").val()),t=angka($("#saldo").val());return""==n?($("#tujuan").addClass("is-invalid"),void $("#tujuan").focus()):0!=parseInt(t)?""==e||e<=0?($("#jumlah").addClass("is-invalid"),void $("#jumlah").focus()):void $.ajax({url:base_url+"kas/simpan_mutasi",type:"POST",data:$(this).serialize(),dataType:"json",beforeSend:function(){$("body").loading()},success:function(a){a.status,sweet_time(2e3,"Status!!!",a.msg),search_Mutasi(),$("#ModalMutasi").modal("hide"),$("body").loading("stop")}}):void sweet_time(2e3,"Status!!!","saldo tidak mencukupi")})),$("#rekening_dari").change((function(){var a=$("#rekening_dari").val();$("#tujuan").attr("disabled",!1),$.ajax({url:base_url+"kas/tujuan_kas",type:"POST",data:{id:a},dataType:"json",beforeSend:function(){$("#tujuan").append("<option value='loading'>loading</option>"),$("#tujuan").empty()},success:function(a){$("#tujuan option[value='loading']").remove(),$("#tujuan").append("<option value=''>Pilih</option>");for(var n=a.length,e=0;e<n;e++){var t=a[e].id,i=a[e].name;$("#tujuan").append("<option value='"+t+"'>"+i+"</option>")}}})}));var jumlah=document.getElementById("jumlah");jumlah.addEventListener("keyup",(function(a){jumlah.value=formatRupiah(this.value,"Rp. "),jml_bayar=angka(this.value),saldo=angka($("#saldo").val()),parseInt(jml_bayar)>parseInt(saldo)&&(sweet_time(2e3,"Status!!!","saldo tidak mencukupi"),$("#jumlah").val(formatMoney(0,0,"Rp.")))}));