function cariFilterIn(a){a=a||0;var i=$("#keyword_cari").val();i.length>=1&&$.ajax({type:"POST",url:base_url+"pencarian/cari_invoice",data:{page:a,keywords:i},beforeSend:function(){$("body").loading({zIndex:1080}),$("#cari_invoice").html('<i class="fa fa-circle-o-notch fa-spin"></i>'),$("#cari_invoice").attr("disabled",!0),$(".alert").hide()},success:function(a){return $("#cari_invoice").attr("disabled",!1),"error"==a?(clear_cari(),sweet_cari("tab1","Peringatan!!!","Maaf No. Order tidak ditemukan","warning","warning"),void $("body").loading("stop")):"ada"==a?(sweet("Peringatan!!!","Maaf No. Order #"+i+" sudah dibatalkan","warning","warning"),clear_cari(),void $("body").loading("stop")):($("#staticBackdrop").modal("show"),$("#hasil_cari").show(),$("#hasil_cari").html(a),$("#cari_invoice").html('<i class="fa fa-search fa-sm"></i>'),void $("body").loading("stop"))},error:function(a,i,e){$("#cari_invoice").html('<i class="fa fa-search fa-sm"></i>'),$("#cari_invoice").attr("disabled",!1),$("body").loading("stop"),console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning")}})}function clear_cari(){$("#keyword_cari").val(""),$("#keyword_cari").focus(),$(".load-cari").loading("stop"),$("#cari_invoice").html('<i class="fa fa-search fa-sm"></i>')}function handleCari(a){if(400!=a.status)return"edit"==a.status?($("#staticBackdrop").modal("hide"),void sweet("Edit!!!","Pembayaran sudah bisa dihapus","success","success")):void simpan_cari(a.idorder,a.idedit,a.idkasir,a.jml);sweet("Peringatan!!!","Maaf Nominal tidak ditemukan","warning","warning")}function simpan_cari(a,i,e,n){$.ajax({url:base_url+"produk/save_cari_invoice",data:{idorder:a,idedit:i,idkasir:e,jml:n},method:"POST",dataType:"json",success:function(a){if(200==a.status)$("#myModalTab").modal("hide");else{if(400!=a.status)return void sweet("Peringatan!!!","Maaf anda tidak punya akses","warning","warning");sweet("Peringatan!!!",a.msg,"warning","warning")}searchFilter(),$("#myModalTab").modal("hide")},error:function(a,i,e){console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning")}})}function cariDesain(){var e=$("#cari_desain").val();e.length>=1&&$.ajax({type:"POST",dataType:"json",url:base_url+"pencarian/cari_invoice_desain",data:{id:e},beforeSend:function(){$(".load-cari").loading({zIndex:1080}),$("#cari_invoice").html('<i class="fa fa-circle-o-notch fa-spin"></i>'),$("#cari_invoice").attr("disabled",!0),$(".alert").hide(),$("#link_folder").val(""),$("#link_pelanggan").val(""),$("#saved_file").val(""),$("#detail_cetak").show()},success:function(e){if(200==e.status){if(huruf=e.konsumen.nama.substring(0,1),folder=e.konsumen.nama+" - "+e.konsumen.no_hp,saved_file=e.save_file.invoice+" - "+e.save_file.ket,huruf.toLowerCase()<="f")var n="A-F";else n=huruf.toLowerCase()<="m"?"G-M":huruf.toLowerCase()<="s"?"N-S":"T-Z";var r="//"+e.folder.computer_name+"/"+n+"/"+huruf+"/"+folder,t="\\\\"+e.folder.computer_name+"\\"+n+"\\"+huruf+"\\"+folder;if($("#link_folder_hide").val(r),$("#link_folder").val(t),$("#link_pelanggan").val(folder),$("#saved_file").val(saved_file),$(".hapusR").remove(),e.detail.length>0)for(i=0;i<e.detail.length;i++){var o=new Date(e.detail[i].tgl_ambil),s=o.getDate()+"."+(o.getMonth()+1)+"."+o.getFullYear()+"_"+o.getHours()+"."+o.getMinutes();if(detail=e.detail[i].detail,finishing="",null!=detail){var d=JSON.parse(detail);if(d.kode==e.detail[i].id_rincianinvoice){if(d.data.length>0)for(a=0;a<d.data.length;a++)finishing="F."+d.data[a].title+"-"+d.data[a].isi+"-"}else finishing=""}file_cetak=e.detail[i].id_transaksi+"-U."+e.detail[i].ukuran+"-Q."+e.detail[i].jumlah+e.detail[i].satuan+"-B."+e.detail[i].bahan+"-P."+e.detail[i].produk+"-K."+e.detail[i].keterangan+"-"+finishing+"TGL."+s+"-FO."+e.detail[i].fo,tampil="<div class='hapusR mb-1'><div class='input-group input-group-sm'><input class='form-control form-control-sm' id='fileD"+i+"' value='"+file_cetak+"' readonly><div class='input-group-append'><button type='button' class='cbtn btn btn-outline-secondary' data-clipboard-target='#fileD"+i+"'>Copy</button></div></div></div>",$("#detail_cetak").append(tampil)}}else $("#cari_desain").val(""),$("#cari_invoice").attr("disabled",!0),sweet_cari("tabb3","Peringatan!!!",e.msg,"warning","warning"),$("#cari_desain").focus(),$(".hapusR").remove();$(".load-cari").loading("stop"),$("#cari_invoice").html('<i class="fa fa-search fa-sm"></i>'),$("#cari_invoice").attr("disabled",!1)},error:function(a,i,e){console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning"),$(".load-cari").loading("stop")}})}function cariFilterOrder(a){a=a||0;var i=$("#cari_order").val();i.length>=1&&$.ajax({type:"POST",url:base_url+"pencarian/cari_invoice_order",data:{page:a,keywords:i},beforeSend:function(){$(".load-cari").loading({zIndex:1080}),$("#cari_invoice_order").html('<i class="fa fa-circle-o-notch fa-spin"></i>'),$("#cari_invoice_order").attr("disabled",!0)},success:function(a){"error"!=a?"ada"!=a?($("#staticBackdrop").modal("show"),$("#hasil_cari_order").show(),$("#hasil_cari_order").html(a),$(".load-cari").loading("stop"),$("#cari_invoice_order").html('<i class="fa fa-search fa-sm"></i>'),$("#cari_invoice_order").attr("disabled",!1)):sweet("Peringatan!!!","Maaf No. Order #"+i+" sudah dibatalkan","warning","warning"):sweet("Peringatan!!!","Maaf No. Order tidak ditemukan","warning","warning")},error:function(a,i,e){$("#cari_invoice_order").html('<i class="fa fa-search fa-sm"></i>'),$("#cari_invoice_order").attr("disabled",!1),$(".load-cari").loading("stop"),console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning")}})}$("#cari_order").keyup((function(){$(".cari_order").prop("disabled",""==this.value)})),$("#cari_desain").keyup((function(){$(".cari_desain,.updateDesain,.cek_folder,.buka_folder,.cbtn").prop("disabled",""==this.value),13==event.keyCode&&cariDesain()})),$("#myModalTab").on("hidden.bs.modal",(function(a){a.preventDefault(),$(this).find("input,textarea,select").val("").end().find("input[type=checkbox], input[type=radio]").prop("checked","").end(),$("#hasil_cari").hide(),$("#hasil_cari_order").hide(),$("#hasil_cari_desain").hide(),$("#detail_cetak").hide()})),$("#myModalTab").on("show.bs.modal",(function(a){$("#link_folder").val(""),$("#link_pelanggan").val(""),$("#saved_file").val(""),$("#cari_desain").val(""),$("#detail_cetak").hide(),setTimeout((function(){$("#keyword_cari").focus()}),1e3)})),$(document).on("click",".cari_invoice",(function(){cariFilterIn()})),$("#keyword_cari").keyup((function(a){13==a.keyCode&&cariFilterIn()})),$(".cari_invoice").prop("disabled",!0),$("#keyword_cari").keyup((function(){$("#hasil_cari").hide(),$(".cari_invoice").prop("disabled",""==this.value)})),$(document).on("click",".save_cari",(function(){var a=$("#idorder").val(),i=$("#idedit").val(),e=$("#idkasir").val(),n=angka($("#jml_uang").val());""==n?0!=i?0!=e?simpan_cari(a,i,e,n):sweet("Peringatan!!!","Maaf kasir masih kosong","warning","warning"):sweet("Peringatan!!!","Maaf Status belum dipilih","warning","warning"):$.ajax({type:"POST",url:base_url+"produk/cari_nominal",data:{idorder:a,idedit:i,idkasir:e,jml:n},success:handleCari,error:function(a,i,e){console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning")}})})),$(document).on("click",".cbtn",(function(){var a=$("#link_folder").val(),i=$("#link_pelanggan").val(),e=$("#saved_file").val();""!=a&&""!=i&&""!=e||sweet("Peringatan!!!","Maaf data masih kosong","warning","warning")})),$(document).on("click",".updateDesain",(function(){var a=$("#cari_desain").val();$.ajax({type:"POST",dataType:"json",url:base_url+"pencarian/update_desain",data:{keywords:a},beforeSend:function(){},success:function(a){cariFilterOrder(),sweet_time(a.timer,"Status!!!",a.msg)}})})),$(document).on("click",".buka_folder",(function(){if(1!=online){var a=$("#link_folder").val();""!=a?$.ajax({type:"POST",dataType:"json",url:base_url+"pencarian/open_folder",data:{folder:a},beforeSend:function(){$(".load-cari").loading({zIndex:1080})},success:function(a){$(".load-cari").loading("stop"),sweet_time(a.timer,"Status!!!",a.msg)},error:function(a,i,e){console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning")}}):sweet("Peringatan!!!","Maaf folder masih kosong","warning","warning")}else sweet("Peringatan!!!","Maaf hanya berlaku jika offline","warning","warning")})),$(document).on("click",".cek_folder",(function(){if(1!=online){var a=$("#link_folder_hide").val();""!=a?$.ajax({type:"POST",dataType:"json",url:base_url+"pencarian/cek_folder",data:{folder:a},beforeSend:function(){$(".load-cari").loading({zIndex:1080})},success:function(a){$(".load-cari").loading("stop"),sweet_time(a.timer,"Status!!!",a.msg)},error:function(a,i,e){console.log(a.status),401==a.status?sweet_login(e,"warning",base_url):sweet("Peringatan!!!",e,"warning","warning")}}):sweet("Peringatan!!!","Maaf link folder masih kosong","warning","warning")}else sweet("Peringatan!!!","Maaf hanya berlaku jika offline","warning","warning")})),$(document).on("click",".cari_order",(function(){cariFilterOrder()})),$("#cari_order").keyup((function(a){13==a.keyCode&&cariFilterOrder()})),$(".cari_desain").prop("disabled",!0),$(".updateDesain").prop("disabled",!0),$(".cari_order").prop("disabled",!0),$(".cek_folder").prop("disabled",!0),$(".buka_folder").prop("disabled",!0),$(".cbtn").prop("disabled",!0),$("#cari_order").keyup((function(){$("#hasil_cari_order").hide(),$(".cari_order").prop("disabled",""==this.value)}));var requireJS=[base_url+"./assets/vendor/mklb/mklb.js"];loadJS(requireJS,base_url+"./assets/js/version.js");